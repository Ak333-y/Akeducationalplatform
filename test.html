<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>テスト</title>
  <link rel="stylesheet" href="style.css">
  <script src="data.js"></script>
</head>
<body>
  <div class="sidebar">
    <h2>📘 テスト中</h2>
  </div>

  <div class="main-content">
    <div class="points">💰 <span id="points"></span> bnp</div>
    <h1 id="subject-title"></h1>
    <div id="question-area"></div>
    <button id="next-btn" style="display:none" onclick="nextQuestion()">次へ</button>
  </div>

  <script>
    const subject = localStorage.getItem("subject");
    document.getElementById("subject-title").innerText = subject + "テスト";
    let score = parseInt(localStorage.getItem("bnp") || 0);
    document.getElementById("points").textContent = score;

    const questions = (data[subject] || []);
    const selected = questions.sort(() => 0.5 - Math.random()).slice(0, 10);
    let current = 0;

    function showQuestion() {
      const q = selected[current];
      if (!q) {
        alert("テスト終了！おつかれ🔥");
        localStorage.setItem("bnp", score);
        window.location.href = "menu.html";
        return;
      }
      const area = document.getElementById("question-area");
      area.innerHTML = `
        <h2>${q.q}</h2>
        ${q.options.map((opt, i) => `<button onclick="checkAnswer(${i})">${opt}</button>`).join('')}
      `;
    }

    function checkAnswer(i) {
      const q = selected[current];
      if (q.answer === i) {
        alert("正解🎯 +1bnp!");
        score++;
        localStorage.setItem("bnp", score);
        document.getElementById("points").textContent = score;
      } else {
        alert("ざんねん💦");
      }
      document.getElementById("next-btn").style.display = "block";
    }

    function nextQuestion() {
      current++;
      document.getElementById("next-btn").style.display = "none";
      showQuestion();
    }

    showQuestion();
  </script>
</body>
</html>
